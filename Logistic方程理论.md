# 一阶差分方程与动力系统初步
## 基本概念
序列$A$的第$n+1$项与$n$项之差,称为这个序列的第$n$**一阶差分**
$$
\Delta a_{n}=a_{n+1}-a_{n}
$$
差分方程的基本结构:
$$
\Delta a_{n}=f(n)
$$
差分方程序列之间的关系称为**动力系统**
满足动力系统的一张$n-b(n)$对照表称为动力系统的**数值解**.
$a_{2}=a_{1}\times 1.01+1000$
$$
\Delta a_{n}=a_{n}\times 0.01+1000
$$
现在的重点是来求解这个差分方程系统,为此,我们需要补充一些概念
## 高阶差分
我们原先定义的$\Delta a_{n}=a_{n+1}-a_{n}$称为**一阶差分**,同样的,$\Delta a_{n}$也可以视作关于非负整数$n$的序列,那么我们也就可以定义$\Delta a_{n}$的差分
$$
\Delta^{2}a_{n}=\Delta a_{n+1}-\Delta a_{n}
$$
这称为$a_{n}$差分的差分,称为**二阶差分**,$\Delta$称之为**差分算子**
```ad-note 
title:差分的一些性质
1. $$\Delta(au_{t}+bv_{t})=a\Delta u_{t}+b\Delta v_{t}$$(差分的线性性)
2. $$\Delta(u_{t}\cdot v_{t})=u_{t}\Delta v_{t}+v_{t+1}\cdot\Delta u_{t}$$(乘法)
```
## 差分方程的一般形式
$$
\begin{flalign*}
&F(t,y_{t},\Delta y_{t},\dots,\Delta^{n}y_{t})\\
&F(t,y_{t},y_{t+1},\dots y_{t+n})
\end{flalign*}
$$
(1)形式的差分方程的差分方程阶数是**最高阶差分的阶数**
(2)形式的差分方程的差分方程阶数是**下标的极差**
## 差分方程解的结构
### 差分方程的解
如果把$y$代入差分方程使得两边恒等,那么这个函数是差分方程的**解**
含有与差分方程阶数相同的任意常数的解,称为差分方程的**通解**,这些常数都被确定的解叫**特解**.
用于确定任意常数的条件就是**初值条件**.
假设我们有$n$阶差分方程:
$$
p_{n(t)}y_{t+n}+\dots+p_{0(t)}y_{t}=f(t)
$$
其中$p_{i}(t),i\in n$是关于$t$的已知函数,且$P_{n}(t)\neq 0$(因为一旦为$0$就不是$n$阶了. )
现在我们对它分类别
- 按是否齐次
    - 所谓齐次,就是右侧$f(t)\doteq0$
        - $f(t)=0\Rightarrow$齐次
        - $f(t)\neq0\Rightarrow$非齐次
- 按系数是否为常值
    - 常系数
    - 变系数
- 按是否线性
    - 右边是线性函数
    - 右边不是线性函数
## 差分方程解结构定理
```ad-info
title:复习:微(差)分方程解的线性无关
指这组解中的任何一个都不能由剩余的解的线性组合来表示,则这组解是**线性无关的**.
```
1. 若$y_{1}(t),\dots,y_{n}(t)$是齐次方程的$n$个**线性无关**的特解,那么对于这个$n$阶齐次差分方程而言,它的**通解**就是$C_{1}y_{1}(t)+\dots+C_{n}y_{n}(t)$
2. 对于非齐次的情形,假设对应齐次方程的通解是$Y(t)$,且我们知道非齐次情形的特解$Y^{*}(t)$,那么非齐次方程的通解就是$Y(t)+Y^{*}(t)$
### 一阶常系数线性差分方程解的结构
$y_{n+1}=ay_{n}$
#### 特征方程
对于齐次的情况而言,我们很容易地注意到通解的形式应当是:$C\lambda^{n}$(鉴于指数函数对倍乘的良好性质)
那么我们代入原来的差分方程
$$C\lambda^{n+1}-a\cdot C\lambda^{n}=0$$
约去项目后得到方程
$$
\lambda-a=0
$$
$$
\lambda=a
$$
这就是一阶常系数齐次线性差分方程的**特征方程**
所以得到$y_{n}=Ca^{n}$是原差分方程的通解.
#### 非齐次
##### 右边是$m$阶多项式的类型
原方程变为$\Delta y_{n}+(1-a)y_{n}=f(n)$的形式.
此时$Y^{*}_{n}$也是多项式,则这样设:
$y_{n}^{*}=\theta_{0}n^m+\theta_{1}n^{m-1}+\dots+\theta_{m}(a\neq 1)$
$y_{n}^{*}=n(\theta_{0}n^m+\theta_{1}n^{m-1}+\dots+\theta_{m})(a = 1)$
##### 右边是$m$阶多项式乘指数的类型
$$
y_{n+1}-ay_{n}=\mu^{n}P_{m}(n)
$$
假如$\mu=0,\mu=1$,相当于没这个指数函数.
其他情况设通解是$y_{n}=\mu^{n}z_{n}$
代入后消去$\mu^{n}$
能有
$$
\mu z_{n+1}-az_{n}=P_{m}(n)
$$
此时就可以转化成上面$\mu$不在起作用的情况
那么是不是就能求出特解.
##### 右边是三角函数乘指数的情况
此时设特解为:
- $m(\cos \beta+\sin \beta i)$不是特征方程的根时
    - $m^{t}(C_{1}\cos \beta t+C_{2}\sin \beta t)$
- $m(\cos \beta+\sin \beta i)$是特征方程的根时
    -  $tm^{t}(C_{1}\cos \beta t+C_{2}\sin \beta t)$
$C_{1},C_{2}$是待定系数.
很容易注意到当$\beta=0$时退化成指数的情形.
****
# Logistic方程和多项式的插值概述
## **Logistic方程**和**Sigmoid函数**
### Logistic方程的提出:**Malthus 模型**
英国统计学家Malthus(1766-1834)在《人口原理》一书中提出自己认识,即**每年人口出生率是一个常数**.
于是他提出了**Malthus人口模型**:
$$
\frac{dN(t)}{dt}=rN(t)
$$
$$
N(t)|_{t=t_{0}}=N_{0}
$$
想必大家注意力惊人,一下就能看出这个方程的解是
$$
N(t)=N_{0}e^{ r(t-t_{0}) }
$$
很显然大家都比Malthus聪明的多,一下就能看出这个方程粗糙而不切实际.因为随着人口数量的不断增加,环境和种内竞争的影响会越来越重.只能这样说:**Malthus人口模型在人口基数不太大的时候,可以被认为是正确的.**
### Logistic 模型
为此数学家**Verhust**改进了这个模型,在Malthus的基础上加上了$-KN^2$的**竞争项**.
此时我们对它求解,得到:
$$
N=\frac{1}{\frac{K}{R}+\left( \frac{1}{N_{0}}-\frac{K}{R} \right)e^{ -rt }}
$$
其中$r,K$是生命系数,一般来说$K\ll R$.
那么在初始阶段,$-KN^2$的竞争项影响小,而之后伴随$N$的增大,$-KN^2$起的作用也随之增大
对于上面的**Logistic模型**
我们有如下的认识:
1. $t\to \infty$,$N(t)\to \frac{R}{K}$
2. 对它求导,可得一阶导数$\frac{d}{dt}N=RN-KN^2=KN\left( \frac{R}{K}-N \right)>0$,所以是**增函数**.求二阶导数得到$\frac{d^2{N}}{dt^2}=(r-2KN)N(r-KN)$,所以在$N\in\left[ 0, \frac{R}{2K} \right)$,曲线上凹,$N\in( \frac{R}{2K} ,+\infty)$曲线下凹
3. 图像:![[Pasted image 20240914122458.png|250]]
4. **Logistic人口模型**的假设条件是:
    1. 个体不分大小,分布均匀,不发生迁入和迁出
    2. 资源供给为一常数,且均匀分配
    3. 种群的每个个体有相同增长率
    4. 种群密度决定的用季度对所有成员影响相同且灵敏地影响种群的增殖
    5. 自然环境提供的资源是有限的.
我们称由Logistic模型确立的方程为**Logistic方程**
方程有如下两种形式：
$$
\frac{dN}{dt}=rN\left( 1-\frac{N}{K} \right)
$$
或者
$$
\frac{dN}{Ndt}=r\left( 1-\frac{N}{K} \right)
$$
当$N=K$时候,很容易注意到:此时人口不再增长，是**平衡态**.
对于Logistic方程而言,$N=0$和$N=K$是它的两个平衡态,$N=0$时不稳定,只有$N=K$时是全局稳定的.
实际上我们也可以通过特征根$f'(0)=r$和$f'(K)=-r$可以看出平衡点的稳定性.
### Sigmoid函数与深度学习概论
刚才学的Logistic方程,它是S型的,一般而言又叫**Sigmoid函数**,或者**S型生长曲线**.狭义地说,Sigmoid函数是如下的函数
$$
S(x)=\frac{1}{1+e^{ -x }}
$$
它的特殊之处在于$S(x)$和$S^{-1}(x)$都是单增的,且$S'(x)$可用$S(x)$表达:
$$
S'(x)=\frac{e^{ -x }}{(1+e^{ -x })^{2}}=S(x)(1-S(x))
$$
如下是Sigmoid函数和它导数的图像
![[Pasted image 20240915174709.png|350]]
它的一些性质:
1. $S(x)\in \left[ 0,1 \right]$,能够对所有的输入作**归一化操作**
2. 因为$S(x)\in \left[ 0,1 \right]$,所以Sigmoid函数很适合用于概率
3. 输出值是平滑的
4. *指数运算*,*权重更新效率低下*,$S(0)\neq 0$,有梯度消失和幂运算复杂的问题
若要使得$S(0)=0$,则可以取
$$
S(x)=\tanh(x)  
$$
它也是Sigmoid函数,并且解决了传统Sigmoid函数中$S(0)\neq 0$的问题,但是梯度消失和幂运算复杂的问题依然存在.
```ad-info
title:名词解释：梯度消失
**梯度消失**是指在神经网络训练过程中，梯度在反向传播过程中变得越来越小，甚至接近于零，导致网络中的某些权重无法有效更新的问题。这个现象通常出现在非常深的神经网络中。

具体来说，梯度消失的原因主要有以下几点：

1. **激活函数的选择**：早期神经网络常使用的Sigmoid或Tanh激活函数，在输入值非常大或非常小的情况下，其导数接近于零。在深度网络中，每一层的梯度乘以上一层的梯度，如果这些梯度都很小，那么连乘之后的结果可能会非常小，导致梯度消失.
2. **深度网络的反向传播**：在深度网络中，如果每一层只能传递一个很小的梯度到下一层，随着层数的增加，梯度信号会不断衰减，最终导致接近输入层的网络层几乎接收不到有效的梯度来更新权重.
3. **权重初始化**：如果权重初始化不当，例如权重过小，那么在反向传播时，梯度乘以权重后的值会更小，也可能导致梯度消失.
4. **学习率的选择**：如果学习率设置得太低，可能会导致梯度更新缓慢，从而在深度网络中引起梯度消失的问题.
```
## Logistic模型的一些拓展
### Logistic 离散模型
$$
N_{n+1}=rN_{n}\left( 1-\frac{N_{n}}{K} \right),n=0,1,2\dots
$$
这种离散方程也称为**虫口方程**.
### 带有时滞的Logistic模型
#### 什么是时滞?
在临港,我们的洗澡水总是**烫的时候很烫，凉 的时候很凉**,于是我们都炼成了自适应水龙头调节的本领(自己适应一下这个水龙头,然后自己调节).
对于这件事情,差点被烫死的肉夹馍发现:水龙头的温度调节并不会立刻反映到水的温度上,而是会滞后一段时间$t$,这称为**时滞**.
肉夹馍又发现:对于家里的水龙头,其反应灵敏,时滞短,所需要来回调节的次数就少.对于学校的水龙头,其反应迟钝,时滞长,所需要来回调节的次数就多.
肉夹馍沉思了一下,觉得这不仅是和洗澡有关的内容,它能用在工程的分析上,也可以用来解释股票和基金的投资,延迟无处不在,迟滞模型也就无处不在.
对于迟滞模型而言,迟滞越严重,就越是容易造成大幅度的不规则振荡,可以用信号来理解.
肉夹馍发现Logistic方程并没有考虑时滞的问题,他着手准备科研,一查资料,我擦,有人干过了!
#### 具有时滞的Logistic模型
最早将时滞引入种群生态学,抢了肉夹馍饭碗的人是生态学家**E.M.Wright**(1945).他直接求出了这个方程,称为E.M.Wright方程:
$$
\frac{dN}{dt}=rN(t)\left( 1- \frac{N(t-\tau)}{k} \right)
$$
其中$\tau$就是时滞.
所以上面的方程其实是一个具有确定时滞的**微分差分方程**.
由于方程中包含 $N(t-\tau)$ 这样的延迟项，这个方程无法用常规的解析方法求解.我们通常使用数值方法来求解这类方程。以下是使用数值方法求解的一般步骤:
1. **初始化**：
    - 选择一个合适的时间步长 $\Delta t$
    - 确定时间范围$t \in [0, T]$
    - 设置初始条件$N(0)$
2. **处理时间延迟**：
    - 由于 $N(t-\tau)$的存在,我们需要知道 $N(t)$ 在 $t-\tau$时刻的值.这意味着在 $t < \tau$ 时,我们需要另外的方法来确定 $N(t)$的值，比如假设 $N(t) = N(0)$,对于$t \in [0, \tau)$.
    - 对于 $t \geq \tau$,我们可以使用历史数据来计算$N(t-\tau)$.
3. **迭代计算**：
    
    - 对于每个时间步$t_n = n \Delta t$,使用前向差分法或其他数值积分方法来更新 $N(t)$
    $$N(t_{n+1}) = N(t_n) + \Delta t \cdot r N(t_n) \left( 1 - \frac{N(t_n - \tau)}{k} \right)$$
    
    - 这里 $N(t_n - \tau)$是在 $t_n - \tau$ 时刻的种群数量，可以从之前计算的结果中获得。
4. **重复迭代**：
    - 重复上述迭代步骤，直到达到预定的结束时间$T$
### Hallam 改进模型
经典Logistic方程有如下的**问题**：
- $r>0$,我们在$N>K$时会有$\frac{dN}{dt}>0$,此时种群个体生的少,死的多时,种群规模超过环境容纳量反而会使得个体数量上升,这是不现实的.
- **随时间变化的Logistic方程**:$$\frac{dN}{dt}=r(t)N(t)\left[ 1-\frac{N(t)}{K(t)} \right]$$当$t\to +\infty$有$r(t),k(t)\to0$,且$$\int_{0}^{+\infty}r(t)  \, dt<+\infty,\int_{0}^{+\infty} \frac{r(t)}{k(t)} \, dt<+\infty $$那么很显然这个时变方程的解:$$N=\frac{N_{0}\exp\left[ \int _{t_{0}}^{t}r(s)\, ds  \right]}{1+N_{0}\int _{t_{0}}^{t}\exp\left[ \int _{t_{0}}^{s}r(s_{1})\, ds_{1} \right] \frac{r(s)}{k(s)} \, ds}$$
便又可知$\lim_{t\to +\infty }N(t)\neq 0$,也就是种群不会灭绝的情况.
为了克服Logistic方程的缺点,**Hallam和Clark**提出了改进后的模型,即
$$
\frac{dN}{dt}=N(t)\left[ r-\frac{C}{B}N(t) \right] 
$$
在这个模型中,内禀增长率$r$的地位被削弱,模型的平衡态变为:
$$
\begin{aligned}
K=r\frac{B}{C},r>0\\
K=0,r\leq 0
\end{aligned}
$$
**经典的模型要求所有的资源被利用,才会进入生长停滞的平衡态.**
但是在**H&C模型**中,种群稳定态$N=K$在环境尚未完全利用的时候达到的.
此时它解决了上面提到的两个问题
- 当内禀增长率$r$为负时,此时根据上面的微分方程,它是单调减函数
- $r(t)$和$B(t)$分别有极限$r_{\infty},B_{\infty}$则每一个具初值的解有$N_{\infty}=B_{\infty}$
### Smith 修正模型
Logistic方程假定种群规模增长率时种群规模的线性函数,这对大部分的种群动力学的议题都是可以接受的.但是科学家**Smith**在研究一种水蚤的过程中发现有关数据不符合线性的规律.此时他假定相对增长率与时刻的剩余食物量
成正比.
$$
\frac{dN}{Ndt}=r\left( 1-\frac{F(t)}{T} \right)
$$
其中$F$是食物消耗率,$T$是规模达到平衡态的食物需要率
那么我们有如下的假定:
- 维持自身生存的食物:$c_{1}N(t)$
- 用于繁殖后代的食物:$c_{2} \frac{dN}{dt}$
所以我们有$F(t)=c_{1}N(t)+c_{2} \frac{dN}{dt}$
则带入上式得到:
$$
\frac{dN}{dt}=rN\left( \frac{T-c_{1}N}{T+rc_{2}N} \right) 
$$
在饱和时,$\frac{dN}{dt}=0,T=c_{1}N_{m}$
$$
\frac{dN}{Ndt}=r\left( \frac{c_{1}N_{m}-c_{1}N-c_{2} \frac{dN}{dt}}{c_{1}N_{m}} \right) 
$$
其实从上面的方程中我们看出,**Smith模型**就是对$\left( 1-\frac{N}{K} \right)$动了刀,修改成了$\frac{T-c_{1}N}{T+rc_{2}N}$,假如$c_{2}=0$,即不考虑食物的需要,那么**Smith模型就退化为Logistic模型**.Smith还发现,密度制约效应所描述的应当是一个下凹的曲线
韩明哲(1988)得出了下面的模型:
$$
\frac{dN}{Ndt}=r\left( \frac{T-F+D \frac{dN}{dt}}{T} \right)=r\left( \frac{c_{1}N_{m}-c_{1}N-(D-c_{2})\frac{dN}{dt}}{c_{1}N_{m}} \right)
$$
不难发现:
$D-c_{2}<0$时是Smith修正方程.
$D-c_{2}=0$时是Logistic方程.












